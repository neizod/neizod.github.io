---
title: ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á‡∏™‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏±‡∏î‡∏Å‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
tags:
  - Mathematics
  - Geometry
  - Linear Algebra
  - Python
  - Algorithm
  - Computer Science
  - Computational Geometry
  - Math Animation
date: 2018-09-13 08:54:20 +0700
revise:
  - date: 2018-09-14 16:56:09 +0700
    note: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ú‡∏•‡∏Ñ‡∏π‡∏ì‡∏à‡∏∏‡∏î ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Ç‡∏≠‡∏á [Pramook Khungurn](//facebook.com/pramook)
---

‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏ß‡∏¥‡∏ä‡∏≤[‡πÄ‡∏£‡∏Ç‡∏≤‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (computational geometry)][computational geometry] ‡∏≠‡∏≤‡∏à‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÅ‡∏Ñ‡πà‡∏ß‡πà‡∏≤ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏ß‡πà‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á‡∏™‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à‡∏ï‡∏±‡∏î‡∏Å‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?

{: .figure}
> ![](/images/algorithm/segment-intersection/cover.png)
>
> ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏Å‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á ‡πÉ‡∏ô‡∏†‡∏≤‡∏û‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡πÅ‡∏Ñ‡πà‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏Ñ‡∏π‡πà‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î‡∏Å‡∏±‡∏ô

‡∏°‡∏≠‡∏á‡πÄ‡∏ú‡∏¥‡∏ô‡πÜ ‡∏ô‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏ã‡πâ‡∏≥ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡πÉ‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ ‡πÅ‡∏ï‡πà‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å ‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡∏à‡∏∏‡∏î‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£? ‡∏•‡∏≠‡∏á‡∏à‡∏¥‡∏ô‡∏ï‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏¢‡∏∑‡∏ô‡∏Ñ‡∏∏‡∏°‡∏´‡∏≤‡∏á‡πÄ‡∏™‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏ó‡πâ‡∏≤‡∏¢‡πÄ‡∏£‡∏∑‡∏≠‡∏•‡∏≥‡∏´‡∏ô‡∏∂‡πà‡∏á (‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á $\overline{pq}$) ‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡∏≠ ‡∏´‡∏≤‡∏Å‡πÄ‡∏£‡∏≤‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏£‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å‡∏•‡∏≥ (‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á $\overline{rs}$) ‡∏°‡∏µ‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡∏≠‡πÅ‡∏•‡∏∞‡∏ó‡πâ‡∏≤‡∏¢‡πÄ‡∏£‡∏∑‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏±‡πâ‡∏á[‡∏Å‡∏£‡∏≤‡∏ö‡∏ã‡πâ‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≤‡∏ö‡∏Ç‡∏ß‡∏≤][port starboard]‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡∏≠‡πÄ‡∏£‡∏≤ (‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏ó‡∏ß‡∏ô‡πÄ‡∏Ç‡πá‡∏°‡πÅ‡∏•‡∏∞‡∏ï‡∏≤‡∏°‡πÄ‡∏Ç‡πá‡∏°‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤) ‡∏ô‡∏±‡πà‡∏ô‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏•‡πà‡∏ô‡∏ï‡∏£‡∏á‡πÜ ‡πÑ‡∏õ‡∏ï‡∏±‡∏î‡πÄ‡∏£‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å‡∏•‡∏≥‡πÑ‡∏î‡πâ

‡πÅ‡∏ï‡πà‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏à‡∏≤‡∏Å‡πÄ‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏´‡∏≤‡∏Å‡∏°‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏£‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å‡∏•‡∏≥ (‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á $\overline{rs}$) ‡∏≠‡∏≤‡∏à‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ (‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á $\overline{pq}$) ‡∏≠‡∏¢‡∏π‡πà‡∏ù‡∏±‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ö‡∏Ç‡∏ß‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏•‡∏≥‡πÄ‡∏•‡∏¢‡∏Å‡πá‡πÑ‡∏î‡πâ (‡πÄ‡∏ä‡πà‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏Å‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô) ‡∏ã‡∏∂‡πà‡∏á‡∏ô‡∏±‡πà‡∏ô‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏•‡πà‡∏ô‡∏ä‡∏ô‡∏Å‡∏±‡∏ô ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á‡∏ï‡∏±‡∏î‡∏Å‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡∏à‡∏∂‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô

‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏ß‡πà‡∏≤‡∏à‡∏∏‡∏î‡πÉ‡∏î‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏°‡∏≤ ‡∏≠‡∏¢‡∏π‡πà‡∏ù‡∏±‡πà‡∏á‡∏ó‡∏ß‡∏ô‡πÄ‡∏Ç‡πá‡∏°‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏≤‡∏Å‡∏¢‡∏±‡∏á‡∏à‡∏≥‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ [‡∏ú‡∏•‡∏Ñ‡∏π‡∏ì‡∏à‡∏∏‡∏î][dot product]‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏™‡∏≠‡∏á‡∏ï‡∏±‡∏ß ‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏ú‡∏•‡∏Ñ‡∏π‡∏ì‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏û‡∏¥‡∏Å‡∏±‡∏î ‡∏ã‡∏∂‡πà‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏ô‡∏≤‡∏ö‡∏™‡∏≠‡∏á‡∏°‡∏¥‡∏ï‡∏¥‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ $\vec{u} \cdot \vec{v} = u_x v_x + u_y v_y$ ‡πÅ‡∏ï‡πà‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÅ‡∏ï‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏•‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡πÅ‡∏Å‡∏ô X-Y ‡πÄ‡∏£‡∏≤‡∏≠‡∏≤‡∏à‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ä‡πâ‡πÅ‡∏Å‡∏ô‡πÉ‡∏î‡πÜ ‡∏ó‡∏µ‡πà‡∏Ç‡∏ô‡∏≤‡∏ô‡∏Å‡∏±‡∏ö $\vec{u}$ ‡πÑ‡∏õ‡πÄ‡∏•‡∏¢‡∏Å‡πá‡πÑ‡∏î‡πâ ‡∏ó‡∏µ‡∏ô‡∏µ‡πâ‡∏ï‡∏≠‡∏ô‡πÅ‡∏ï‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î $\vec{v}$ ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡∏™‡∏ô‡πÉ‡∏à‡πÅ‡∏Ñ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏ô‡∏≤‡∏ô‡∏Å‡∏±‡∏ö $\vec{u}$ ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ú‡∏•‡∏Ñ‡∏π‡∏ì‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÉ‡∏ô‡πÅ‡∏Å‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏â‡∏≤‡∏Å‡∏Å‡∏±‡∏ô‡∏à‡∏∞‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå) ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡πá‡∏à‡∏∞‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏û‡∏µ‡∏¢‡∏á $\vec{u}\cdot\vec{v} = \abs{\vec{u}}\abs{\vec{v}}\cos\theta$ ‡πÄ‡∏°‡∏∑‡πà‡∏≠ $\theta$ ‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏∏‡∏°‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á $\vec{u}$ ‡∏ô‡∏±‡∏ö‡∏ß‡∏ô‡∏ó‡∏ß‡∏ô‡πÄ‡∏Ç‡πá‡∏°‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤‡πÑ‡∏õ‡∏´‡∏≤ $\vec{v}$

{: .figure}
> ![](/images/math/dot-product.gif)
>
> ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏•‡∏Ñ‡∏π‡∏ì‡∏à‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡πÇ‡∏î‡∏¢‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÅ‡∏ó‡∏ô‡∏Ñ‡πà‡∏≤‡∏ú‡∏•‡∏Ñ‡∏π‡∏ì‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å

‡πÄ‡∏£‡∏≤‡∏≠‡∏≤‡∏à‡∏°‡∏≠‡∏á‡∏ú‡∏•‡∏Ñ‡∏π‡∏ì‡∏à‡∏∏‡∏î‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡∏Ç‡∏≠‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡∏Å $\vec{v}$ ‡∏•‡∏á‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô $\vec{v}'$ ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î $\abs{\vec{v}}\cos\theta$ ‡∏ö‡∏ô‡πÅ‡∏Å‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏Å‡∏±‡∏ö $\vec{u}$ ‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏£‡πâ‡∏≤‡∏á $\vec{v}_N'$ ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô $\vec{v}'$ ‡∏ó‡∏ß‡∏ô‡πÄ‡∏Ç‡πá‡∏°‡πÑ‡∏õ $90^\circ$ ‡∏≠‡∏á‡∏®‡∏≤ ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏ú‡∏∑‡∏ô‡∏ú‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô $\vec{u}$ ‡πÅ‡∏•‡∏∞ $\vec{v}_N'$ ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å‡∏Å‡πá‡∏ï‡πà‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠ $\vec{v}$ ‡∏°‡∏µ‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ô‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö $\vec{u}$ (‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ô‡πÉ‡∏ô‡∏ó‡∏¥‡∏®‡∏ï‡∏£‡∏á‡∏Ç‡πâ‡∏≤‡∏° ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏â‡∏≤‡∏Å‡∏Å‡∏±‡∏ô‡∏û‡∏≠‡∏î‡∏µ) ... ‡πÅ‡∏ï‡πà‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏ß‡πà‡∏≤ $\vec{v}$ ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏ó‡∏ß‡∏ô‡πÄ‡∏Ç‡πá‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏≤‡∏°‡πÄ‡∏Ç‡πá‡∏°‡∏à‡∏≤‡∏Å $\vec{u}$ ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á $\vec{u}_N = \left[\begin{smallmatrix}-u_y \newline u_x\end{smallmatrix}\right]$ ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ß‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏â‡∏≤‡∏Å‡πÉ‡∏ô‡∏ó‡∏¥‡∏®‡∏ó‡∏ß‡∏ô‡πÄ‡∏Ç‡πá‡∏°‡∏Å‡∏±‡∏ö $\vec{u}$ ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì $\vec{u}_N\cdot\vec{v}$ ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏ú‡∏•‡∏Ñ‡∏π‡∏ì‡∏à‡∏∏‡∏î‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠ $0^\circ<\theta<180^\circ$ ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠ $180^\circ<\theta<360^\circ$ ‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á (‡πÇ‡∏î‡∏¢ $\theta$ ‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏∏‡∏°‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á $\vec{u}$ ‡∏Å‡∏±‡∏ö $\vec{v}$ ‡πÄ‡∏î‡∏¥‡∏° ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏°‡∏∏‡∏°‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏á $\vec{u}_N$ ‡∏Å‡∏±‡∏ö $\vec{v}$)

‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏à‡∏≤‡∏Å[‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡πà‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ ($\sgn$)][sign function] ‡πÄ‡∏£‡∏≤‡∏≠‡∏≤‡∏à‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏à‡∏∏‡∏î $v$ ‡∏≠‡∏¢‡∏π‡πà‡∏ù‡∏±‡πà‡∏á‡∏ó‡∏ß‡∏ô‡πÄ‡∏Ç‡πá‡∏°‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤‡∏à‡∏≤‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á‡∏à‡∏≤‡∏Å‡∏à‡∏∏‡∏î $(0,0)$ ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏à‡∏∏‡∏î $u$ ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ

$$
\begin{align*}
CCW(u, v, w)
&= \sgn(\vec{u}_N \cdot \vec{v}) \\
&= \sgn(u_x v_y - u_y v_x) \\
&= \sgn \begin{vmatrix} u_x & v_x \\ u_y & v_y \end{vmatrix}
\end{align*}
$$

‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡∏ß‡πà‡∏≤ $\vec{u}$ ‡πÅ‡∏•‡∏∞ $\vec{v}$ ‡∏ô‡∏±‡πâ‡∏ô ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ß‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÇ‡∏î‡∏ô[‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô][translation]‡∏°‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î $(0,0)$ ‡∏´‡∏≤‡∏Å‡πÄ‡∏ß‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ñ‡∏∑‡∏≠ $\vec{w}$ ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô[‡∏î‡∏µ‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏°‡∏¥‡πÅ‡∏ô‡∏ô‡∏ï‡πå][determinant]‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô‡∏à‡∏∞‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô

$$
\begin{vmatrix}
u_x-w_x & v_x-w_x \\
u_y-w_y & v_y-w_y
\end{vmatrix} =
\begin{vmatrix}
u_x & v_x & w_x \\
u_y & v_y & w_y \\
1   & 1   & 1
\end{vmatrix}
$$

(‡∏û‡∏≠‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏∏‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏≤‡∏Å‡πÜ ‡∏à‡∏ô‡∏ô‡∏±‡πà‡∏á‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ô‡πá‡∏ï‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å‡∏ã‡∏±‡∏Å‡∏û‡∏±‡∏Å‡∏Å‡πá‡∏û‡∏ö‡∏ß‡πà‡∏≤ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏≠‡∏≤‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏î‡∏µ‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏°‡∏¥‡πÅ‡∏ô‡∏ô‡∏ï‡πå‡πÑ‡∏õ‡∏´‡∏≤‡∏£‡∏™‡∏≠‡∏á‡∏Å‡πá‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏û‡∏≠‡∏î‡∏µ! ... ‡πÇ‡∏≠‡πâ‡πÇ‡∏´ ‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡∏≠‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡πÄ‡∏£‡∏µ‡∏¢‡∏ô[‡∏û‡∏µ‡∏ä‡∏Ñ‡∏ì‡∏¥‡∏ï‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏™‡πâ‡∏ô][linear algebra]‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ üòÇ)

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô $CCW$ ‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∞‡∏´‡∏≤‡∏ß‡πà‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á $\overline{pq}$ ‡πÅ‡∏•‡∏∞ $\overline{rs}$ ‡∏ï‡∏±‡∏î‡∏Å‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡∏Å‡πá‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡πÄ‡∏û‡∏µ‡∏¢‡∏á

$$
\begin{align*}
CUT(\overline{pq}, \overline{rs}) &= CCW(p, q, r) \oplus CCW(p, q, s) \\
INTERSECT(\overline{pq}, \overline{rs}) &= CUT(\overline{pq}, \overline{rs}) \land CUT(\overline{rs}, \overline{pq})
\end{align*}
$$

## ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á

- Don Sheehy, 2010. Computational Geometry: Lecture 3.

---

‡∏õ.‡∏•. ‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡πÇ‡∏Ñ‡πâ‡∏î Python ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏Ñ‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏ï‡∏≤‡∏° üòâ

``` python
from operator import mul
from functools import reduce
from collections import namedtuple

prod = lambda ls: reduce(mul, ls)

Matrix = namedtuple('Matrix', 'm')      # dimension 3x3 only.
Matrix.from_points = lambda u, v, w: Matrix([ [u.x, v.x, w.x],
                                              [u.y, v.y, w.y],
                                              [  1,   1,   1] ])
Matrix.diag_down = lambda self: ((self.m[j][(i+j)%3] for j in range(3))
                                                     for i in range(3))
Matrix.diag_up = lambda self: ((self.m[j][(i+3-j)%3] for j in range(3))
                                                     for i in range(3))
Matrix.det = lambda self: ( sum(prod(d) for d in self.diag_down())
                          - sum(prod(d) for d in self.diag_up()) )

Point = namedtuple('Point', 'x y')

Segment = namedtuple('Segment', 'p q')
Segment.from_floats = lambda x0, y0, x1, y1: Segment(Point(x0, y0), Point(x1, y1))
Segment.ccw = lambda self, p: Matrix.from_points(p, *self).det() > 0
Segment.through = lambda self, other: self.ccw(other.p) ^ self.ccw(other.q)
Segment.intersect = lambda self, other: self.through(other) and other.through(self)


# example
import matplotlib.pyplot as plt
segments = [ Segment.from_floats(0.4, 0.8, 1.5, 1.6),
             Segment.from_floats(0.0, 4.2, 2.3, 0.0) ]
print('Segment intersect?', segments[0].intersect(segments[1]))
plt.plot(*(pair for a, b in segments for pair in [(a.x, b.x), (a.y, b.y)]))
plt.show()
```


[computational geometry]: //en.wikipedia.org/wiki/Computational_geometry
[dot product]: //en.wikipedia.org/wiki/Dot_product
[port starboard]: //en.wikipedia.org/wiki/Port_and_starboard
[sign function]: //en.wikipedia.org/wiki/Sign_function
[translation]: //en.wikipedia.org/wiki/Translation_(geometry)
[determinant]: //en.wikipedia.org/wiki/Determinant
[linear algebra]: //en.wikipedia.org/wiki/Linear_algebra
