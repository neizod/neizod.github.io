---
title: ‡πÅ‡∏Å‡πâ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå‡∏á‡∏≤‡∏ô ‡∏£‡∏ß‡∏°‡∏û‡∏•‡∏±‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå $O(n \log n)$
tags:
  - Programming Interview Question
  - Competitive Programming
  - Python
  - Dynamic Programming
  - Divide and Conquer
date: 2022-02-09 00:05:55 +0700
---

‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏à‡∏≠‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏≠‡∏ô‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå‡∏á‡∏≤‡∏ô‡∏à‡∏≤‡∏Å‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏ù‡∏±‡πà‡∏á‡∏ã‡∏¥‡∏•‡∏¥‡∏Ñ‡∏≠‡∏ô‡∏ß‡∏±‡∏•‡πÄ‡∏•‡∏¢‡πå ‡πÇ‡∏î‡∏¢‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏¥‡∏î‡∏≠‡∏±‡∏•‡∏Å‡∏≠‡∏£‡∏¥‡∏ó‡∏∂‡∏°‡∏°‡∏≤‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏≠‡∏≤‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏¢‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏ã‡πâ‡∏≥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á (‡πÅ‡∏•‡∏∞‡∏≠‡∏≠‡∏Å‡∏à‡∏∞‡πÅ‡∏õ‡∏•‡∏Å‡πÉ‡∏à‡∏î‡πâ‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÄ‡∏ä‡∏¥‡∏á‡πÅ‡∏Ç‡πà‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏°‡∏≤‡∏≠‡∏≠‡∏Å) ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Å‡πá‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏ó‡∏≤‡∏á‡∏ù‡∏±‡πà‡∏á‡∏Ñ‡∏ô‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå‡∏ô‡∏±‡πâ‡∏ô‡∏Ñ‡∏á*‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à*‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏¢‡∏≤‡∏Å‡∏°‡∏≤‡∏Å‡πÜ ‡∏à‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ó‡∏≤‡∏á‡∏ó‡∏≥‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤ ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏î‡∏π‡πÅ‡∏Ñ‡πà‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÅ‡∏ï‡πà‡∏î‡∏π‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏¥‡∏î‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏à‡∏∂‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏°‡∏≤‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏ô‡∏±‡πâ‡∏ô‡πÜ ‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ô‡∏µ‡πâ‡∏Å‡πá‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡∏î‡πâ‡∏ß‡∏¢‡∏´‡∏•‡∏∞‡∏°‡∏±‡πâ‡∏á ‡∏ß‡πà‡∏≤‡∏ñ‡πâ‡∏≤‡πÄ‡∏à‡∏≠‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏¢‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏°‡∏±‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏á (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö[‡πÇ‡∏Ñ‡∏ö‡∏≤‡∏¢‡∏≤‡∏ä‡∏¥‡∏°‡∏≤‡∏£‡∏∏][kobayashi maru]‡πÑ‡∏á‡∏´‡∏•‡∏∞!)

‡∏ã‡∏∂‡πà‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÄ‡∏à‡πâ‡∏≤‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ô‡∏µ‡πâ‡∏Å‡πá‡∏™‡∏ô‡∏∏‡∏Å‡∏î‡∏µ ‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏î‡πâ‡∏ß‡∏¢ (‡πÅ‡∏•‡∏∞‡∏Å‡πá‡∏î‡∏µ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å [fizz buzz][] ‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πâ‡∏à‡∏∞‡∏ß‡∏±‡∏î‡∏≠‡∏∞‡πÑ‡∏£‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á[^1] ‡πÅ‡∏ï‡πà‡∏Å‡πá‡∏ô‡∏±‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡πà‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß) ‡πÇ‡∏î‡∏¢‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏™‡∏ô‡∏∏‡∏Å‡∏°‡∏≤‡∏Å‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß $O(n^3)$ ‡πÇ‡∏î‡∏¢‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡∏ï‡∏£‡∏á‡πÑ‡∏õ‡∏ï‡∏£‡∏á‡∏°‡∏≤ ‡∏ã‡∏∂‡πà‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏õ‡πá‡∏ô $O(n^2)$ ‡πÑ‡∏î‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ä‡∏≤‡∏ç‡∏â‡∏•‡∏≤‡∏î ‡πÅ‡∏ï‡πà‡∏Å‡πá‡∏¢‡∏±‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡πÅ‡∏¢‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏≤‡∏ä‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠ $O(n \log n)$ ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö ‡∏à‡∏ô‡∏ó‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∏‡∏î‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏•‡∏ß‡∏±‡∏ï‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô $O(n \log n)$ ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ... ‡∏Å‡πá‡∏Ç‡∏≠‡∏à‡∏î‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡∏≠‡∏±‡∏ô‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏´‡∏ô‡πà‡∏≠‡∏¢ ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡πà‡∏ß‡∏°‡∏™‡∏ô‡∏∏‡∏Å‡πÑ‡∏õ‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå/‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå‡πÄ‡∏≠‡∏á‡∏ö‡πâ‡∏≤‡∏á ü§™


## ‡πÇ‡∏à‡∏ó‡∏¢‡πå: ‡∏£‡∏ß‡∏°‡∏û‡∏•‡∏±‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå

‡∏°‡∏≠‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå $n$ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏°‡∏¥‡∏ï‡∏¥ $X$ ‡πÇ‡∏î‡∏¢‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏ô‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ï‡πá‡∏°‡∏ö‡∏ß‡∏Å ‡πÅ‡∏ó‡∏ô‡∏û‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÜ ‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ $p(X[\ell \ldots r])$ ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏û‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà $\ell$ ‡πÑ‡∏õ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà $r$ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô ‡∏ã‡∏∂‡πà‡∏á‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö

$$
p(X[\ell \ldots r]) = \min(X[\ell \ldots r]) \cdot \sum X[\ell \ldots r]
$$

‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÉ‡∏´‡πâ‡∏´‡∏≤ $P(X)$ ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏•‡∏±‡∏á‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏à‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏ó‡∏∏‡∏Å‡πÜ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏¥‡∏î‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô ‡∏ô‡∏±‡πà‡∏ô‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏´‡πâ‡∏´‡∏≤

$$
P(X) = \sum_{i=0}^{n-1} \; \sum_{j=i}^{n-1} \; p(X[i \ldots j])
$$

(‡∏à‡∏≥‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏≠‡∏á $n$ ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏°‡∏≤‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡∏∂‡∏Å‡∏≠‡∏≠‡∏Å‡∏Å‡∏±‡∏ô‡πÄ‡∏ñ‡∏≠‡∏∞)


## ‡∏Ñ‡∏¥‡∏î‡∏ï‡∏£‡∏á‡πÑ‡∏õ‡∏ï‡∏£‡∏á‡∏°‡∏≤ $O(n^3)$

‡∏ñ‡∏∂‡∏á‡∏ß‡∏¥‡∏ò‡∏µ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÉ‡∏´‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏¢‡πà‡πÅ‡∏ô‡πà‡πÜ ‡πÅ‡∏ï‡πà‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡πÑ‡∏ß‡πÅ‡∏•‡∏∞‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡∏´‡∏£‡∏≠‡∏Å‡πÄ‡∏ô‡∏≠‡∏∞

``` python
def p(xs):
    return min(xs) * sum(xs)

def total_power(xs):
    n = len(xs)
    return sum(p(xs[i:j+1]) for i in range(n) for j in range(i, n))
```

‡∏ã‡∏∂‡πà‡∏á‡∏°‡∏±‡∏ô‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ö‡∏≠‡∏Å‡πÄ‡∏•‡∏¢‡∏ô‡∏µ‡πà‡∏´‡∏ß‡πà‡∏≤ 5555555555555555

‡∏≠‡∏ô‡∏∂‡πà‡∏á ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ß‡πà‡∏≤‡πÉ‡∏ô Python ‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πÑ‡∏•‡∏ã‡πå‡∏ã‡∏±‡∏ö‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå $X[i \ldots j]$ (‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏±‡∏ß‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡πÉ‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á $j$ ‡∏î‡πâ‡∏ß‡∏¢) ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏õ‡πá‡∏ô `xs[i:j+1]` ‡∏ô‡∏±‡πà‡∏ô‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ö‡∏ß‡∏Å‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏•‡∏á‡πÑ‡∏õ ‡∏ô‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏Ñ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏Ç‡∏≠‡∏á Python ‡∏ó‡∏µ‡πà‡∏°‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πÑ‡∏•‡∏ã‡πå‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏•‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏±‡∏ß[^2] ‡∏ã‡∏∂‡πà‡∏á‡∏Å‡πá‡∏î‡∏π‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏Å‡∏±‡∏ö `range(n)` ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ô‡∏±‡∏ö‡πÄ‡∏•‡∏Ç‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà `0` ‡πÑ‡∏õ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡πÅ‡∏Ñ‡πà `n-1` ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô


## ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏£‡πá‡∏ß $O(n^2)$

‡∏ó‡∏µ‡πà‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏ô‡πÅ‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ä‡πâ‡∏≤‡∏ñ‡∏∂‡∏á $O(n^3)$ ‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ‡∏•‡∏π‡∏õ‡∏ñ‡∏∂‡∏á‡∏™‡∏≤‡∏°‡∏ä‡∏±‡πâ‡∏ô ‡πÇ‡∏î‡∏¢‡∏™‡∏≠‡∏á‡∏ä‡∏±‡πâ‡∏ô‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `total_power` ‡∏ô‡∏±‡πâ‡∏ô‡∏û‡∏≠‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ä‡∏±‡∏î ‡πÅ‡∏ï‡πà‡∏•‡∏π‡∏õ‡∏≠‡∏µ‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `p` ‡∏ô‡∏±‡πâ‡∏ô‡πÇ‡∏î‡∏ô‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏†‡∏≤‡∏©‡∏≤ ‡∏ã‡∏∂‡πà‡∏á‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `min` ‡πÅ‡∏•‡∏∞ `sum` ‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô $O(n)$ ‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á ‡πÄ‡∏£‡∏≤‡∏≠‡∏≤‡∏à‡∏°‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏™‡∏≠‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î ‡∏ã‡∏∂‡πà‡∏á‡∏°‡∏±‡∏ô‡∏Ñ‡∏á‡∏à‡∏∞‡∏î‡∏µ‡πÑ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πà‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏û‡∏ß‡∏Å‡∏°‡∏±‡∏ô‡∏•‡∏á‡πÑ‡∏î‡πâ

‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö `sum` ‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏¢‡∏≤‡∏Å ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡πÅ‡∏ô‡∏ß[‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏•‡∏ß‡∏±‡∏ï][dynamic programming] ‡πÇ‡∏î‡∏¢‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ß‡πà‡∏≤‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏ß‡πâ‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ ‡πÇ‡∏î‡∏¢‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î‡∏ñ‡∏∂‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÜ ([cumsum][]) ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤

$$
\begin{align}
Y[0] &= X[0] \\
Y[1] &= X[0] + X[1]        &&{\color{grey}= Y[0] + X[1]} \\
Y[2] &= X[0] + X[1] + X[2] &&{\color{grey}= Y[1] + X[2]} \\
&\;\;\vdots &&{\color{grey}\;\vdots} \\
Y[n{-}1] &= X[0] + X[1] + X[2] + \cdots X[n{-}1]
\end{align}
$$

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏ú‡∏•‡∏£‡∏ß‡∏°‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡∏±‡∏ö‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå‡πÉ‡∏´‡∏°‡πà‡∏°‡∏≤‡∏•‡∏ö‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠

$$
\sum X[i \ldots j] = Y[j] - Y[i{-}1]
$$

‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏ß‡πâ‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡∏∑‡∏≠ $O(n)$ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡πá‡∏ô $O(1)$

‡πÅ‡∏ï‡πà‡∏Å‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `min` ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÄ‡∏ä‡πà‡∏ô‡∏ô‡∏±‡πâ‡∏ô ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏°‡∏¥‡∏ï‡∏¥‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÅ‡∏ö‡∏ö `sum` ‡∏°‡∏≤‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏û‡∏≠‡∏à‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå‡∏™‡∏≠‡∏á‡∏°‡∏¥‡∏ï‡∏¥‡∏°‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ `min` ‡πÅ‡∏ó‡∏ô ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ

$$
\begin{align}
Z[0][0] &= X[0] \\
Z[0][1] &= \min(X[0], X[1])       &&{\color{grey}= \min(Z[0][0], X[1])} \\
Z[0][2] &= \min(X[0], X[1], X[2]) &&{\color{grey}= \min(Z[0][1], X[2])} \\
&\;\;\vdots &&{\color{grey}\;\vdots} \\
Z[i][j] &= \min(X[i \ldots j])    &&{\color{grey}= \min(Z[i][j{-}1], X[j])} \\
&\;\;\vdots \\
Z[n{-}1][n{-}1] &= X[n{-}1]
\end{align}
$$

‡∏ã‡∏∂‡πà‡∏á‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå‡∏™‡∏≠‡∏á‡∏°‡∏¥‡∏ï‡∏¥‡∏ô‡∏µ‡πâ‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏õ‡πá‡∏ô $O(n^2)$ ‡πÅ‡∏ï‡πà‡∏Å‡πá‡∏¢‡∏±‡∏á‡∏û‡∏≠‡∏°‡∏µ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏´‡πâ‡πÉ‡∏à‡∏ä‡∏∑‡πâ‡∏ô‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ `min` ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏û‡∏µ‡∏¢‡∏á $O(1)$ ‡πÅ‡∏•‡πâ‡∏ß (‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô[‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à][range min query]‡πÉ‡∏´‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö ‡πÅ‡∏ï‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏£‡∏≤‡∏ï‡∏¥‡∏î‡∏Ñ‡∏≠‡∏Ç‡∏ß‡∏î‡∏ó‡∏µ‡πà $O(n^2)$ ‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏õ‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏ä‡∏±‡πâ‡∏ô‡∏ô‡∏≠‡∏Å‡∏≠‡∏¢‡∏π‡πà‡∏î‡∏µ)

‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß‡πÉ‡∏ô $O(n^2)$ ‡∏Ñ‡∏∑‡∏≠

``` python
def init_query_sum(xs):
    ys = [0 for _ in xs]
    for i, x in enumerate(xs):
        ys[i] = ys[i-1] + x
    return ys

def query_sum(i, j, ys):
    if i == 0:
        return ys[j]
    return ys[j] - ys[i-1]

def init_query_min(xs):
    n = len(xs)
    zs = [[1e400 for _ in range(n)] for _ in range(n)]
    for i in range(n):
        for j in range(i, n):
            zs[i][j] = min(zs[i][j-1], xs[j])
    return zs

def query_min(i, j, zs):
    return zs[i][j]

def p(i, j, ys, zs):
    return query_min(i, j, zs) * query_sum(i, j, ys)

def total_power(xs):
    n = len(xs)
    ys = init_query_sum(xs)
    zs = init_query_min(xs)
    return sum(p(i, j, ys, zs) for i in range(n) for j in range(i, n))
```


## ‡πÅ‡∏ö‡πà‡∏á‡πÅ‡∏¢‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏≤‡∏ä‡∏ô‡∏∞ $O(n \log n)$ ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢

‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ß‡πà‡∏≤‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏•‡∏≠‡∏á‡πÅ‡∏à‡∏Å‡πÅ‡∏à‡∏á‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏≠‡∏∞‡πÑ‡∏£‡∏ã‡∏±‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏™‡∏ô‡πÉ‡∏à‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå $X =[a,b,c,d,e,f]$ ‡∏ó‡∏µ‡πà‡∏°‡∏µ $d$ ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î ‡πÉ‡∏´‡πâ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ñ‡∏ß‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏á (‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ö‡∏ß‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏ï‡∏≤) ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏≤‡πÑ‡∏•‡πà‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡∏à‡∏ô‡∏Ñ‡∏£‡∏ö ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏û‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ä‡πà‡∏ô‡∏ô‡∏µ‡πâ

$$
\begin{array}{cccccc}
a & b & c & d & e & f \\
\hline
a \\
a & b \\
a & b & c \\
a & b & c & {\color{red}d} \\
a & b & c & {\color{red}d} & e \\
a & b & c & {\color{red}d} & e & f \\
  & b \\
  & b & c \\
  & b & c & {\color{red}d} \\
  & b & c & {\color{red}d} & e \\
  & b & c & {\color{red}d} & e & f \\
  &   & c \\
  &   & c & {\color{red}d} \\
  &   & c & {\color{red}d} & e \\
  &   & c & {\color{red}d} & e & f \\
  &   &   & {\color{red}d} \\
  &   &   & {\color{red}d} & e \\
  &   &   & {\color{red}d} & e & f \\
  &   &   &   & e \\
  &   &   &   & e & f \\
  &   &   &   &   & f
\end{array}
\quad\quad\Rightarrow\quad\quad
\begin{array}{cccccc}
a & b & c & d & e & f \\
\hline
a \\
a & b \\
a & b & c \\
  & b \\
  & b & c \\
  &   & c \\
\hdashline
a & b & c & {\color{red}d} \\
a & b & c & {\color{red}d} & e \\
a & b & c & {\color{red}d} & e & f \\
  & b & c & {\color{red}d} \\
  & b & c & {\color{red}d} & e \\
  & b & c & {\color{red}d} & e & f \\
  &   & c & {\color{red}d} \\
  &   & c & {\color{red}d} & e \\
  &   & c & {\color{red}d} & e & f \\
  &   &   & {\color{red}d} \\
  &   &   & {\color{red}d} & e \\
  &   &   & {\color{red}d} & e & f \\
\hdashline
  &   &   &   & e \\
  &   &   &   & e & f \\
  &   &   &   &   & f
\end{array}
$$

‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏¢‡∏Å‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ $d$ ‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏≠‡∏¢‡∏π‡πà ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Å‡∏±‡πâ‡∏ô‡πÅ‡∏ñ‡∏ß‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≤‡∏°‡∏û‡∏≤‡∏ó‡∏¥‡∏ä‡∏±‡∏ô ‡πÇ‡∏î‡∏¢‡∏û‡∏≤‡∏ó‡∏¥‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏°‡∏µ‡∏ó‡∏∏‡∏Å‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ $d$ ‡∏Å‡∏≥‡∏Å‡∏±‡∏ö ‡∏™‡πà‡∏ß‡∏ô‡∏û‡∏≤‡∏ó‡∏¥‡∏ä‡∏±‡∏ô‡∏ö‡∏ô‡∏à‡∏∞‡∏°‡∏µ‡∏ó‡∏∏‡∏Å‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡∏π‡πà‡∏ù‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á $d$ ‡πÄ‡∏ä‡πà‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏û‡∏≤‡∏ó‡∏¥‡∏ä‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤‡∏Ç‡∏≠‡∏á $d$ ‡∏ô‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ[‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á][recursion]‡∏à‡∏≤‡∏Å‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ[‡πÅ‡∏ö‡πà‡∏á‡πÅ‡∏¢‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏≤‡∏ä‡∏ô‡∏∞][divide and conquer]‡∏°‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏Å‡πâ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÑ‡∏î‡πâ ‡πÇ‡∏î‡∏¢‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ç‡∏≠‡∏á‡∏û‡∏≤‡∏ó‡∏¥‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á ‡πÅ‡∏•‡πâ‡∏ß‡πÇ‡∏¢‡∏ô‡∏û‡∏≤‡∏ó‡∏¥‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÑ‡∏õ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏¢‡∏¥‡∏ö‡∏¢‡πà‡∏≠‡∏¢‡∏•‡∏á‡πÑ‡∏õ

‡∏ã‡∏∂‡πà‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏≤‡∏ó‡∏¥‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏Ñ‡∏π‡∏ì‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ñ‡∏ß ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏£‡∏≤*‡πÄ‡∏•‡∏∑‡∏≠‡∏Å*‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏£‡∏π‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö $d$ ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Å‡πá‡πÅ‡∏Ñ‡πà‡∏ô‡∏±‡∏ö‡∏ß‡πà‡∏≤‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏Å‡∏µ‡πà‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

‡πÉ‡∏´‡πâ $S$ ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ã‡∏ï‡∏Ç‡∏≠‡∏á‡πÅ‡∏ñ‡∏ß‡∏ó‡∏∏‡∏Å‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏°‡∏≤‡πÉ‡∏ô‡∏û‡∏≤‡∏ó‡∏¥‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ß‡πà‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠

$$
\sum S = 3a + 6b + 9c + 12d + 8e + 4f
$$

‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ß‡πà‡∏≤ $a$ ‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡∏Ñ‡∏π‡∏ì $3$ ‡∏ï‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà ‡∏ô‡∏±‡πà‡∏ô‡∏Å‡πá‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏™‡∏≤‡∏°‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏ã‡∏∂‡πà‡∏á‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏à‡∏ö‡∏î‡πâ‡∏ß‡∏¢ $d$ ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡∏°‡∏≤‡∏à‡∏ö‡∏ó‡∏µ‡πà $e$ ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà $f$ ‡∏ô‡∏±‡πà‡∏ô‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤‡∏à‡∏≤‡∏Å $d$ ‡πÑ‡∏õ‡∏à‡∏ô‡∏™‡∏∏‡∏î‡∏Ç‡πâ‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà ‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∂‡∏á‡πÄ‡∏≠‡∏≤‡∏°‡∏≤‡∏Ñ‡∏π‡∏ì $a$ ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢

‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡∏∑‡∏≠ $b$ ‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡∏Ñ‡∏π‡∏ì $3{\cdot}2$ ‡∏ï‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà ‡πÇ‡∏î‡∏¢‡∏Ñ‡πà‡∏≤ $3$ ‡∏ô‡∏±‡πâ‡∏ô‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÉ‡∏ô‡∏ó‡∏≥‡∏ô‡∏≠‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏Å‡∏±‡∏ö $3a$ ‡∏ß‡πà‡∏≤‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏∏‡∏î‡∏°‡∏±‡∏ô‡∏Å‡∏¥‡∏ô‡πÅ‡∏ñ‡∏ß‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å $[d, e, f]$ ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏Ñ‡∏π‡∏ì $2$ ‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà $b$ ‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ä‡∏∏‡∏î‡πÅ‡∏£‡∏Å‡πÇ‡∏î‡∏¢‡∏°‡∏µ $a$ ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á‡πÇ‡∏î‡∏¢‡∏ï‡∏±‡∏ß‡∏ã‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î‡∏Ñ‡∏∑‡∏≠ $b$

‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡πÄ‡∏ä‡πà‡∏ô‡∏ô‡∏µ‡πâ ‡πÄ‡∏£‡∏≤‡∏à‡∏∂‡∏á‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤

$$
\begin{align}
\sum S
&= 3 \Big( 1a + 2b + 3c \Big) + \Big( 3 \cdot 4 \Big)d + 4 \Big( 2e + 1f \Big)
\\
&= \left( \sum_{i=0}^{k-1} k(i{+}1) \cdot X[i] \right)
 + \Big( k(n{-}k) \cdot \min(X) \Big)
 + \left( \sum_{i=n-1}^{k+1} (n{-}k)(n{-}i) \cdot X[i] \right)
\end{align}
$$

‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà $k$ ‡∏Ñ‡∏∑‡∏≠‡∏î‡∏±‡∏ä‡∏ô‡∏µ‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î‡∏Ñ‡∏∑‡∏≠‡∏ï‡∏±‡∏ß $d$ ‡∏ã‡∏∂‡πà‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ $k=3$ ‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á

‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∂‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏ä‡πà‡∏ô‡∏ô‡∏µ‡πâ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤

```python
def total_power(xs):
    if not xs:
        return 0
    min_value = min(xs)
    k = xs.index(min_value)
    left, right = xs[:k], xs[k+1:]
    count = ( (len(right)+1) * sum(i*x for i, x in enumerate(left, 1))
            + (len(left)+1) * (len(right)+1) * min_value
            + (len(left)+1) * sum(i*x for i, x in enumerate(right[::-1], 1)) )
    return count*min_value + total_power(left) + total_power(right)
```

‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ $O(n)$ ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏ä‡∏±‡πâ‡∏ô ‡∏ã‡∏∂‡πà‡∏á‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏ö‡πà‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏≤‡∏ó‡∏¥‡∏ä‡∏±‡∏ô‡∏ö‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏û‡∏≠‡πÜ ‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ ‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏•‡∏∂‡∏Å‡∏•‡∏á‡πÑ‡∏õ‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏à‡∏∞‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏•‡∏∂‡∏Å‡∏•‡∏á‡πÑ‡∏õ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÅ‡∏Ñ‡πà $O(\log n)$ ‡∏ä‡∏±‡πâ‡∏ô ‡∏à‡∏∂‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤‡∏≠‡∏±‡∏•‡∏Å‡∏≠‡∏£‡∏¥‡∏ó‡∏∂‡∏°‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô $O(n \log n)$ ‡∏´‡∏≤‡∏Å‡πÄ‡∏£‡∏≤‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ‡πÄ‡∏à‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß

‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡πÇ‡∏ä‡∏Ñ‡∏£‡πâ‡∏≤‡∏¢ ‡πÄ‡∏à‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡πà‡∏á‡∏û‡∏≤‡∏ó‡∏¥‡∏ä‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å‡πÜ ‡πÄ‡∏ä‡πà‡∏ô ‡∏û‡∏≤‡∏ó‡∏¥‡∏ä‡∏±‡∏ô‡∏ö‡∏ô‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå‡∏ß‡πà‡∏≤‡∏á ‡∏™‡πà‡∏ß‡∏ô‡∏û‡∏≤‡∏ó‡∏¥‡∏ä‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡πÄ‡∏•‡∏¢ ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏•‡∏∂‡∏Å‡∏•‡∏á‡πÑ‡∏õ $O(n)$ ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ä‡πà‡∏ô‡∏ô‡∏µ‡πâ ‡∏à‡∏ô‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏¢‡πà‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô $O(n^2)$ ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö[‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡πá‡∏ß][quicksort]‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ä‡πâ‡∏≤‡∏ö‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô)


## ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏•‡∏ß‡∏±‡∏ï $O(n \log n)$ ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á

‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠‡πÑ‡∏ß‡πâ‡πÉ‡∏à‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏à‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡πÑ‡∏´‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡πà‡∏≤ ... ‡∏•‡∏≠‡∏á‡πÅ‡∏Å‡∏•‡πâ‡∏á‡πÜ ‡∏•‡∏∑‡∏°‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏π‡∏ì‡∏Ñ‡πà‡∏≤ `min` ‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ñ‡∏ß‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô ‡∏à‡∏≤‡∏Å‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå $X=[a,b,c,d,e,f]$ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏à‡∏Å‡πÅ‡∏à‡∏á‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏à‡∏≤‡∏Å‡∏ã‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î‡∏ñ‡∏∂‡∏á‡πÅ‡∏Ñ‡πà‡∏ï‡∏±‡∏ß $e$ ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ

$$
\begin{array}{c:cccccc}
t & a & b & c & d & e & f \\
\hline
0 & a \\
\hdashline
1 & a & b \\
  &   & b \\
\hdashline
2 & a & b & c \\
  &   & b & c \\
  &   &   & c \\
\hdashline
3 & a & b & c & d \\
  &   & b & c & d \\
  &   &   & c & d \\
  &   &   &   & d \\
\hdashline
4 & a & b & c & d & e\\
  &   & b & c & d & e\\
  &   &   & c & d & e\\
  &   &   &   & d & e \\
  &   &   &   &   & e \\
\end{array}
$$

‡∏´‡∏£‡∏µ‡πà‡∏ï‡∏≤‡∏°‡∏≠‡∏á‡∏î‡∏π‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ñ‡∏π‡∏Å‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡πÜ ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô ‡πÉ‡∏´‡πâ $T[t]$ ‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡πÉ‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà $t$ ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤

$$
\begin{align}
T[0] &= a \\
T[1] &= a + 2b \\
T[2] &= a + 2b + 3c \\
T[3] &= a + 2b + 3c + 4d \\
T[4] &= a + 2b + 3c + 4d + 5d
\end{align}
$$

‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° $f$ ‡∏ã‡∏∂‡πà‡∏á‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ï‡∏±‡∏ß‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡πÅ‡∏Ñ‡πà‡πÄ‡∏≠‡∏≤‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏≤‡∏ö‡∏ß‡∏Å $f$ ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏ã‡∏∂‡πà‡∏á‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ $T[5] = T[4] + 6f$ ‡∏Å‡πá‡∏û‡∏≠‡πÅ‡∏•‡πâ‡∏ß

‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏û‡∏•‡∏±‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ $P(X) = \sum_{t=0}^{n-1} T[t]$ ‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á

‡∏ó‡∏µ‡∏ô‡∏µ‡πâ‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏∂‡∏á‡∏ñ‡∏∂‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö ‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ñ‡∏ß‡∏ô‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡∏ß‡∏Ñ‡∏π‡∏ì `min` ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢ ‡∏™‡∏ô‡πÉ‡∏à‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ä‡∏±‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ï‡∏≠‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏° $f$ ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÅ‡∏ú‡∏ô‡∏†‡∏≤‡∏û‡πÄ‡∏ä‡πà‡∏ô‡∏ô‡∏µ‡πâ

$$
\begin{array}{c:cccccc}
\min & a & b & c & d & e & f \\
\hline
m_0 & a & b & c & d & e & \color{red}f \\
m_1 &   & b & c & d & e & \color{red}f \\
m_2 &   &   & c & d & e & \color{red}f \\
m_3 &   &   &   & d & e & \color{red}f \\
m_4 &   &   &   &   & e & \color{red}f \\
\color{red}m_5   &&&&&&   \color{red}f
\end{array}
$$

‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà $m_i$ ‡∏ô‡∏±‡πâ‡∏ô‡∏ö‡∏≠‡∏Å‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÜ ‡∏ã‡∏∂‡πà‡∏á‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ $m_i = \min(X[i\ldots4])$ ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤

$$
\begin{align}
T[4]
&= m_0a + (m_0+m_1)b + \cdots + \sum_{i=0}^4 m_i e
\end{align}
$$

‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° $f$ ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á $T[5]$ ‡∏•‡∏≠‡∏á‡∏Ñ‡∏¥‡∏î**‡πÄ‡∏Ñ‡∏™‡∏á‡πà‡∏≤‡∏¢**‡∏Å‡πà‡∏≠‡∏ô ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ß‡πà‡∏≤ $f$ ‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏∏‡∏Å $m_i$ ‡πÄ‡∏•‡∏¢ ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° $f$ ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏∂‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏õ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡πà‡∏≤ $m_i$ ‡∏à‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏Ñ‡∏π‡∏ì‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö $f$ ‡∏Ñ‡∏∑‡∏≠

$$
T[5] = T[4] + (m_0 + m_1 + m_2 + m_3 + m_4 + m_5)f
$$

‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà $m_5=f$ ‡∏ô‡∏±‡πà‡∏ô‡∏Å‡πá‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ß‡πà‡∏≤‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏û‡∏µ‡∏¢‡∏á $f$ ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á

‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏£‡∏π‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏Ñ‡πà‡πÑ‡∏´‡∏ô‡∏ß‡πà‡∏≤ $f$ ‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ $m_i$ ‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤? ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏Ç‡πâ‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ñ‡∏∑‡∏≠

$$
m_0 \le m_1 \le m_2 \le m_3 \le m_4
$$

‡∏ô‡∏±‡πà‡∏ô‡∏Å‡πá‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà $i$ ‡πÄ‡∏£‡∏≤‡∏ß‡∏¥‡πà‡∏á‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ `min` ‡∏à‡∏≤‡∏Å‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ‡∏ì ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏î‡∏±‡∏ä‡∏ô‡∏µ $i$ ‡πÑ‡∏õ‡∏ñ‡∏∂‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡∏™‡∏∏‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏±‡πâ‡∏ô ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà $j$ ‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏ó‡∏≤‡∏á ‡∏´‡∏≤‡∏Å‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ $m_i$ ‡∏ö‡∏≤‡∏á‡∏ï‡∏±‡∏ß ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡πÑ‡∏õ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤ $m_i$ ‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà $j$ ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏≤‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤ $m_i$ ‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÑ‡∏õ‡∏°‡∏≤‡∏Å‡πÄ‡∏™‡∏°‡∏≠ ‡πÄ‡∏£‡∏≤‡∏à‡∏∂‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ[‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ó‡∏ß‡∏¥‡∏†‡∏≤‡∏Ñ][binary search]‡∏ó‡∏µ‡πà‡πÄ‡∏£‡πá‡∏ß $O(\log n)$ ‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤ $f$ ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡πÅ‡∏•‡∏∞‡∏ñ‡πâ‡∏≤‡∏°‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ $m_i$ ‡∏ï‡∏±‡∏ß‡πÑ‡∏´‡∏ô‡∏ö‡πâ‡∏≤‡∏á

‡∏ã‡∏∂‡πà‡∏á‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤**‡πÄ‡∏Ñ‡∏™‡∏¢‡∏≤‡∏Å**‡∏ó‡∏µ‡πà $f$ ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÅ‡∏•‡πâ‡∏ß ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡∏î‡∏±‡∏ä‡∏ô‡∏µ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∑‡∏ô‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ó‡∏ß‡∏¥‡∏†‡∏≤‡∏Ñ‡∏Ñ‡∏∑‡∏≠ $k=3$ ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ $m_2 < f \le m_3$ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏ú‡∏ô‡∏†‡∏≤‡∏û‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤

$$
\begin{array}{c:cccccc}
\min & a & b & c & d & e & f \\
\hline
m_0 & \color{blue}a & \color{blue}b & \color{blue}c & d & e & \color{red}f \\
m_1 && \color{blue}b & \color{blue}c & d & e & \color{red}f \\
m_2 &&& \color{blue}c & d & e & \color{red}f \\
{\color{red}f} &&&& \color{limegreen}d & \color{limegreen}e & \color{red}f \\
{\color{red}f} &&&&& \color{limegreen}e & \color{red}f \\
{\color{red}f} &&&&&& \color{red}f 
\end{array}
$$

‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏ö‡πà‡∏á‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì $T[5]$ ‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πà‡πÇ‡∏ã‡∏ô ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ

- **‡πÇ‡∏ã‡∏ô‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢** ‡∏à‡∏≤‡∏Å $a$ ‡πÑ‡∏õ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á $c$ (‡∏Å‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á $k$ ‡∏ä‡πà‡∏≠‡∏á) ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏ô‡∏µ‡πâ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ñ‡∏ß‡∏¢‡∏±‡∏á‡∏Ñ‡∏π‡∏ì‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÅ‡∏ñ‡∏ß‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ‡∏à‡∏∂‡∏á‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å $T[2]$ ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢
- **‡πÇ‡∏ã‡∏ô‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á** ‡∏à‡∏≤‡∏Å $d$ ‡πÑ‡∏õ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á $e$ ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß‡πÉ‡∏ô $O(1)$ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏≠‡∏≤‡∏°‡∏≤‡∏Ñ‡∏π‡∏ì‡∏Å‡∏±‡∏ö $f$ ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏Å‡∏¥‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏ñ‡∏ß‡∏Å‡πá‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß
- **‡πÇ‡∏ã‡∏ô‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏™‡∏µ‡∏î‡∏≥‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á** ‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô‡∏à‡∏≤‡∏Å $d$ ‡πÑ‡∏õ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á $e$ ‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á‡∏à‡∏≤‡∏Å $m_0$ ‡πÑ‡∏õ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á $m_2$ ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏Å‡πâ‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å $\left(\sum_{i=k}^{4}X[i]\right)\left(\sum_{i=0}^{k-1} m_i\right)$ ‡∏ã‡∏∂‡πà‡∏á‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠‡∏´‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ñ‡∏π‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á ‡πÇ‡∏î‡∏¢‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏•‡∏£‡∏ß‡∏°‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß‡πÉ‡∏ô $O(1)$ ‡πÄ‡∏ä‡πà‡∏ô‡πÄ‡∏î‡∏¥‡∏°
- **‡πÇ‡∏ã‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏£‡∏á‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤** ‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ $\sum_{i=0}^5m_if$ ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡πà‡∏≤ $m_i$ ‡∏ö‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÑ‡∏õ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß ... ‡∏≠‡∏ô‡∏∂‡πà‡∏á‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏°‡∏≠‡∏á‡πÉ‡∏´‡πâ‡πÇ‡∏ã‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å‡∏î‡πâ‡∏ß‡∏¢ ‡πÇ‡∏î‡∏¢‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡πÇ‡∏ã‡∏ô‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏™‡∏µ‡∏î‡∏≥‡πÅ‡∏•‡∏∞‡πÇ‡∏ã‡∏ô‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏°‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡∏≠‡∏µ‡∏Å‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏à‡∏ô‡∏Ñ‡∏•‡∏∏‡∏° $f$ ‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á

‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏Å‡∏¥‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏û‡∏µ‡∏¢‡∏á $O(\log n)$ ‡πÑ‡∏°‡πà‡∏°‡∏≤‡∏Å‡πÑ‡∏õ‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô $O(n)$ ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏à‡∏∂‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô $O(n \log n)$ ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

``` python
from bisect import bisect_left

class MonotoneBisector(object):
    def __init__(self):
        self.idxs = [-1]
        self.mins = [-1e400]
        self.sums = [0]
        self._seen_elements = 0

    def add(self, x):
        i = bisect_left(self.mins, x)
        del self.idxs[i:], self.mins[i:], self.sums[i:]
        self.idxs += [self._seen_elements]
        self.mins += [x]
        self.sums += [self.sums[-1] + x*(self.idxs[-1]-self.idxs[-2])]
        self._seen_elements += 1
        return self.idxs[-2]

class PowerDP(object):
    _slice_line = lambda s, k: s._line[-1] - s._line[k]
    _slice_rect = lambda s, k: k * s._slice_line(k)
    _slice_trig = lambda s, k: s._trig[-1] - s._trig[k] - s._slice_rect(k)
    _left = lambda s, k: s._right[k]
    _rect = lambda s, k: s._mono.sums[-2] * s._slice_line(k)
    _down = lambda s, k: s._mono.mins[-1] * s._slice_trig(k)

    def __init__(self):
        self._mono = MonotoneBisector()
        self._line = [0]
        self._trig = [0]
        self._right = [0]

    def add(self, x):
        k = 1 + self._mono.add(x)
        self._line += [self._line[-1] + x]
        self._trig += [self._trig[-1] + x*len(self._trig)]
        self._right += [self._left(k) + self._rect(k) + self._down(k)]
        return self._right[-1]

def total_power(xs):
    dp = PowerDP()
    return sum(dp.add(x) for x in xs)
```


[^1]: [‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠][tom scott fizz buzz]‡πÅ‡∏Å‡πâ‡πÇ‡∏à‡∏ó‡∏¢‡πå FizzBuzz ‡∏à‡∏≤‡∏Å Tom Scott
[^2]: [‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£][python tutorial strings]‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Python ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô


[tom scott fizz buzz]: //youtu.be/QPZ0pIK_wsc
[fizz buzz]: //en.wikipedia.org/wiki/Fizz_buzz
[kobayashi maru]: //en.wikipedia.org/wiki/Kobayashi_Maru
[python tutorial strings]: //docs.python.org/3/tutorial/introduction.html#strings
[cumsum]: //en.wikipedia.org/wiki/Prefix_sum
[range min query]: //en.wikipedia.org/wiki/Range_minimum_query
[quicksort]: //en.wikipedia.org/wiki/Quicksort
[recursion]: //en.wikipedia.org/wiki/Recursion
[divide and conquer]: //en.wikipedia.org/wiki/Divide-and-conquer_algorithm
[dynamic programming]: //en.wikipedia.org/wiki/Dynamic_programming
[binary search]: //en.wikipedia.org/wiki/Binary_search_algorithm