---
title: "Hacker Cup 2020: ‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤‡πÉ‡∏ô‡∏ö‡πà‡∏≠‡∏ô‡πâ‡∏≥"
tags:
  - Facebook Hacker Cup
  - Competitive Programming
  - Probability
  - Dynamic Programming
  - Python
date: 2021-01-04 21:38:04 +0700
people:
  neizod: author, illustrator
  nonthaphat: coauthor, coder
---

‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏à‡∏≤‡∏Å‡∏£‡∏≠‡∏ö‡∏ä‡∏¥‡∏á‡∏Ç‡∏ô‡∏∞‡πÄ‡∏•‡∏¥‡∏®‡∏Ç‡∏≠‡∏á Facebook Hacker Cup ‡∏õ‡∏µ 2020 ‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πâ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏¢‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡πÅ‡∏ï‡πà‡∏Å‡πá‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à‡πÉ‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏∞‡∏î‡∏±‡∏ö (‡πÅ‡∏•‡∏∞‡∏´‡∏≤‡∏Å‡πÑ‡∏•‡πà‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ó‡∏≤‡∏á‡∏Å‡πá‡∏à‡∏∞‡∏Ñ‡∏¥‡∏î‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î) ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà[‡∏Ç‡πâ‡∏≠ Pond Precipitation][problem statement] ‡∏ó‡∏µ‡πà‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÉ‡∏´‡πâ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡πà‡∏≠‡∏ô‡πâ‡∏≥‡πÅ‡∏´‡πà‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏≠‡∏¢‡∏π‡πà ‡πÅ‡∏•‡πâ‡∏ß‡∏ñ‡∏≤‡∏°‡∏´‡∏≤[‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á][expectation]‡∏ß‡πà‡∏≤‡∏ù‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏µ‡πà‡∏´‡∏¢‡∏î‡∏à‡∏∂‡∏á‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤‡∏à‡∏°‡∏ô‡πâ‡∏≥ ‡πÇ‡∏î‡∏¢‡∏Ñ‡∏≥‡∏ô‡∏∂‡∏á‡∏ß‡πà‡∏≤‡∏ù‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡∏¢‡∏î‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ï‡∏Å‡∏•‡∏á‡∏¢‡∏±‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏ô‡∏ö‡πà‡∏≠‡∏ô‡πâ‡∏≥‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô

‡∏ô‡∏±‡πà‡∏ô‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ ‡∏´‡∏≤‡∏Å‡πÉ‡∏´‡πâ $X$ ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ó‡∏ô‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡∏´‡∏¢‡∏î‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤‡∏à‡∏°‡∏ô‡πâ‡∏≥ ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏´‡∏≤

$$
E(X) = \sum_{d \in \mathbb{N}} d \cdot P(X=d)
$$


## ‡πÅ‡∏õ‡∏•‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°

‡πÅ‡∏°‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏ö‡πà‡∏≠‡∏ô‡πâ‡∏≥) ‡∏à‡∏∞‡πÄ‡∏•‡πá‡∏Å‡πÄ‡∏û‡∏µ‡∏¢‡∏á $n=30$ ‡πÅ‡∏•‡∏∞‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏ù‡∏ô‡∏ï‡∏Å‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô $n^2$ ‡∏´‡∏¢‡∏î‡∏Å‡πá‡∏à‡∏∞‡∏ó‡πà‡∏ß‡∏°‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤ ‡πÅ‡∏ï‡πà‡∏´‡∏≤‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ä‡πâ[‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ][algorithm]‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏´‡∏¢‡∏î‡∏ô‡πâ‡∏≥‡∏ù‡∏ô[‡∏ó‡∏∏‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö][brute force] ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ‡∏û‡∏∏‡πà‡∏á‡∏™‡∏π‡∏á‡πÄ‡∏õ‡πá‡∏ô $O(n^{n^2})$ ‡∏ô‡∏±‡πà‡∏ô‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ó‡∏≤‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡∏ô‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏Å‡πá‡∏ï‡∏≤‡∏° ‡∏´‡∏≤‡∏Å‡πÉ‡∏Ñ‡∏£‡∏Ñ‡∏∏‡πâ‡∏ô‡πÄ‡∏Ñ‡∏¢‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏ô‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ ‡∏Å‡πá‡∏à‡∏∞‡πÄ‡∏î‡∏≤‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ß‡πà‡∏≤‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ä‡πâ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô $O(n^6)$ ‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ô‡∏∂‡∏Å‡∏ñ‡∏∂‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏ï‡∏£‡∏∞‡∏Å‡∏π‡∏•‡∏ô‡∏µ‡πâ ‡∏Å‡πá‡∏Ñ‡∏á‡∏´‡∏ô‡∏µ‡πÑ‡∏°‡πà‡∏û‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ[‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏•‡∏ß‡∏±‡∏ï][dynamic programming]‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á

‡∏ñ‡∏∂‡∏á‡∏Å‡∏£‡∏∞‡∏ô‡∏±‡πâ‡∏ô ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏°‡∏≠‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ñ‡∏π‡∏Å‡πÅ‡∏Å‡πâ‡πÇ‡∏î‡∏¢‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏•‡∏ß‡∏±‡∏ï‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏ô‡∏µ‡πâ ‡∏Ñ‡∏∑‡∏≠ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÅ‡∏ö‡πà‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏ï‡πâ‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ç‡∏±‡πâ‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏•‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ä‡∏¥‡πâ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÉ‡∏î) ‡πÑ‡∏•‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ ‡πÇ‡∏î‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ä‡∏¥‡πâ‡∏ô‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡πÅ‡∏Å‡πâ‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏•‡πá‡∏Å‡∏°‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏ô

‡πÅ‡∏ï‡πà‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Å‡∏é‡∏ß‡πà‡∏≤‡∏´‡∏¢‡∏î‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏Å‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÑ‡∏´‡∏•‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Ç‡∏ß‡∏≤ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏°‡∏≠‡∏á‡πÄ‡∏ú‡∏¥‡∏ô‡πÜ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏•‡∏ß‡∏±‡∏ï‡πÑ‡∏î‡πâ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏¢‡πà‡∏≠‡∏¢‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡πÄ‡∏´‡∏•‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ô‡πÑ‡∏õ‡∏´‡∏°‡∏î‡∏à‡∏ô‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏•‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏Å‡πâ

‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏Å‡πá‡∏ï‡∏≤‡∏° ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏ï‡πà‡∏≥‡∏Ç‡∏≠‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡πÇ‡∏à‡∏ó‡∏¢‡πå ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏¢‡πà‡∏≠‡∏¢‡πÜ ‡∏´‡∏•‡∏≤‡∏¢‡∏ö‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Å‡∏±‡∏ô ‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡πà‡∏≠‡∏ñ‡∏π‡∏Å‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ß‡∏≤‡∏á‡∏£‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏é‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏ß‡πâ‡∏ß‡πà‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏à‡∏ô‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏•‡πâ‡∏ß ‡∏ô‡πâ‡∏≥‡∏ó‡∏µ‡πà‡∏•‡πâ‡∏ô‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏à‡∏∞‡πÑ‡∏´‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ö‡πà‡∏≠‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤‡∏à‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏•‡πâ‡∏ô‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ö‡πà‡∏≠‡∏ã‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î ‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏ù‡∏≤‡∏Å‡πÑ‡∏ß‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡∏≠‡πà‡∏≤‡∏ô üòú

{: .oversized .figure}
> ![](/images/algorithm/misc/pond-precipitation.png)
>
> ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡πà‡∏≠‡∏ô‡πâ‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏¢‡πà‡∏≠‡∏¢‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏•‡πâ‡∏ô‡∏à‡∏∞‡∏•‡πâ‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ö‡πà‡∏≠‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô ‡∏à‡∏≤‡∏Å‡∏ö‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏ï‡∏±‡πâ‡∏á‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á $n$ ‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÅ‡∏õ‡∏•‡∏á‡∏°‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏¢‡πà‡∏≠‡∏¢‡πÜ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô $m \le n$ ‡∏ö‡πà‡∏≠ ‡πÇ‡∏î‡∏¢‡∏ö‡πà‡∏≠‡∏ó‡∏µ‡πà $i$ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡∏∏‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡πÑ‡∏î‡πâ $c_i$ ‡∏´‡∏¢‡∏î ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á $w_i$ ‡∏´‡∏ô‡πà‡∏ß‡∏¢

‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ß‡πà‡∏≤ ‡∏ö‡πà‡∏≠‡∏ã‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î (‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏ö‡πà‡∏≠‡∏ó‡∏µ‡πà $1$) ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡πá‡πÑ‡∏î‡πâ ‡∏´‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤‡πÉ‡∏ô‡∏ö‡πà‡∏≠‡∏¢‡πà‡∏≠‡∏¢‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏≤‡∏Å‡∏ö‡πà‡∏≠‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡∏ó‡∏µ‡πà‡∏ö‡πà‡∏≠‡∏Ç‡∏ß‡∏≤‡∏™‡∏∏‡∏î (‡∏ã‡∏∂‡πà‡∏á‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠‡∏ö‡πà‡∏≠‡∏ó‡∏µ‡πà $m$) ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏ö‡∏ö‡πà‡∏≠‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÇ‡∏î‡∏¢‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏ß‡∏≤‡∏Ç‡∏≠‡∏á‡∏ö‡πà‡∏≠‡∏ô‡∏µ‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏Ç‡∏≠‡∏ö‡∏ã‡πâ‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢


## ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏•‡∏ß‡∏±‡∏ï‡∏ï‡∏£‡∏á‡πÑ‡∏õ‡∏ï‡∏£‡∏á‡∏°‡∏≤

‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏•‡∏ß‡∏±‡∏ï‡∏°‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏™‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡∏´‡∏¢‡∏î‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß $d$ ‡∏´‡∏¢‡∏î ‡∏à‡∏∞‡∏°‡∏µ‡∏Å‡∏µ‡πà‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡∏•‡πâ‡∏ô‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏ó‡πà‡∏ß‡∏°‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤ ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ô‡∏≥‡πÑ‡∏õ‡∏´‡∏≤‡∏£‡∏Å‡∏±‡∏ö‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏Å‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏Å‡πá‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤ $P(X=d)$ ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á

‡πÉ‡∏´‡πâ $S(i,d)$ ‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡πà‡∏ß‡∏°‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ù‡∏ô‡∏ï‡∏Å‡∏°‡∏≤ $d$ ‡∏´‡∏¢‡∏î‡∏û‡∏≠‡∏î‡∏µ ‡πÇ‡∏î‡∏¢‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ö‡πà‡∏≠‡∏ã‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏ö‡πà‡∏≠‡∏ó‡∏µ‡πà $i$ ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¥‡∏™‡∏£‡∏∞‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏Å $d-1$ ‡∏´‡∏¢‡∏î ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏¢‡∏î‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏¢‡∏î‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ï‡∏Å‡∏•‡∏á‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≥‡∏•‡πâ‡∏ô‡∏à‡∏ô‡∏ó‡πà‡∏ß‡∏°‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤

‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤ ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏ó‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Ç‡∏≠‡∏á $S(i, d)$ ‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏≤‡∏ä‡πà‡∏ß‡∏¢ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡∏≠‡∏¥‡∏™‡∏£‡∏∞‡∏ä‡∏∏‡∏î‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏™‡∏•‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡∏≠‡∏¥‡∏™‡∏£‡∏∞‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤‡∏à‡∏°‡∏ô‡πâ‡∏≥‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏ö‡πà‡∏≠‡πÄ‡∏ï‡πá‡∏° ‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏≠‡∏¥‡∏™‡∏£‡∏∞‡∏´‡∏¢‡∏∏‡∏î‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ä‡∏∏‡∏î‡πÄ‡∏Å‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏¢‡∏î‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤‡∏à‡∏°‡∏ô‡πâ‡∏≥ ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏Å‡πá‡∏ï‡∏≤‡∏° ‡∏´‡∏≤‡∏Å‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡∏≠‡∏¥‡∏™‡∏£‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ä‡∏∏‡∏î‡∏ï‡∏Å‡∏°‡∏≤‡∏à‡∏ô‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏•‡∏ó‡∏∏‡∏Å‡∏ö‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤‡∏à‡∏°‡∏ô‡πâ‡∏≥ ‡∏Å‡πá‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏£‡∏ì‡∏µ‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏ó‡∏µ‡πà‡∏ù‡∏ô‡∏´‡∏¢‡∏î‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏à‡∏∞‡∏ï‡∏Å‡∏ï‡∏£‡∏á‡πÑ‡∏´‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ ‡∏ã‡∏∂‡πà‡∏á‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ‡∏Ñ‡∏π‡∏ì‡∏Å‡∏±‡∏ö‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡∏ï‡∏Å‡∏°‡∏≤ $d$ ‡∏´‡∏¢‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ï‡πá‡∏°‡∏ö‡πà‡∏≠‡∏û‡∏≠‡∏î‡∏µ‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏ó‡πà‡∏ß‡∏°‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤‡πÅ‡∏ó‡∏ô

‡πÉ‡∏´‡πâ $H(i,d)$ ‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ó‡πà‡∏ß‡∏°‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ù‡∏ô‡∏ï‡∏Å‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß $d$ ‡∏´‡∏¢‡∏î ‡πÇ‡∏î‡∏¢‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ö‡πà‡∏≠‡∏ã‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏ö‡πà‡∏≠‡∏ó‡∏µ‡πà $i$ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏≤ $S$ ‡πÅ‡∏•‡∏∞ $H$ ‡πÑ‡∏î‡πâ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ

$$
\begin{align}
S(i, d+1) &=
  \begin{cases}
    \displaystyle \left( \sum_{k = 1}^i w_k \right) \cdot H(i, d) &
    \displaystyle \text{if } d = \sum_{k=1}^i c_k \\
    \displaystyle \sum_{\substack{a, b \in \mathbb{N}_0 \\ a+b = d}}
                  \binom{d}{b} \cdot w_i^b \cdot S(i, a+1) &
    \displaystyle \text{if } d \lt \sum_{k=1}^i c_k \\
    0 & \text{otherwise}
  \end{cases}
\\ \\
H(i, d) &=
  \begin{cases}
    1 & \text{if } i = 0 \text{ and } d = 0 \\
    \displaystyle \sum_{\substack{a, b \in \mathbb{N}_0 \\ a+b = d}}
                  \binom{d}{b} \cdot w_i^b \cdot H(i, a) &
    \displaystyle \text{if } d \le \sum_{k=1}^i c_k \\
    0 & \text{otherwise}
  \end{cases}
\end{align}
$$

‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏∑‡∏≠

$$
E(X) = \sum_{d \in \mathbb{N}} d \cdot \frac{S(m, d)}{n^d}
$$


## ‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡πà‡∏ß‡∏¢

‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô‡πÅ‡∏°‡πâ‡∏à‡∏∞‡∏ï‡∏£‡∏á‡πÑ‡∏õ‡∏ï‡∏£‡∏á‡∏°‡∏≤‡πÅ‡∏ï‡πà‡∏Å‡πá‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏™‡∏π‡∏á ‡πÅ‡∏ñ‡∏°‡∏¢‡∏±‡∏á‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏•‡∏ß‡∏±‡∏ï‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ñ‡∏∂‡∏á‡∏™‡∏≠‡∏á‡∏ï‡∏±‡∏ß ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏Å‡πá‡∏ï‡∏≤‡∏°‡πÄ‡∏£‡∏≤‡∏≠‡∏≤‡∏à‡πÅ‡∏õ‡∏•‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô ‡πÇ‡∏î‡∏¢‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á‡∏°‡∏µ‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ

$$
\begin{align}
E(X) &= \sum_{d \in \mathbb{N}} d \cdot P(X=d) \\
     &= 1 \cdot P(X=1) + 2 \cdot P(X=2) + 3 \cdot P(X=3) + \cdots \\
     &=
     \begin{pmatrix}
     P(X=1) &+& P(X=2) &+& P(X=3) &+& \cdots \\
            &+& P(X=2) &+& P(X=3) &+& \cdots \\
            & &        &+& P(X=3) &+& \cdots \\
            & &        & &        &+& \ddots
     \end{pmatrix} \\
     &= P(X \ge 1) + P(X \ge 2) + P(X \ge 3) + \cdots \\
     &= \sum_{d \in \mathbb{N}} P(X \ge d)
\end{align}
$$

‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏°‡∏≤‡πÅ‡∏õ‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á $P(X \ge d)$ ‡∏Å‡∏±‡∏ô ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ß‡πà‡∏≤ $X$ ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ó‡∏ô**‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡∏´‡∏¢‡∏î‡∏ó‡∏µ‡πà**‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤‡∏à‡∏°‡∏ô‡πâ‡∏≥ ‡∏ô‡∏±‡πà‡∏ô‡∏Å‡πá‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤ $X \ge d$ ‡∏à‡∏∞‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡πÄ‡∏´‡∏ï‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡∏´‡∏¢‡∏î‡πÉ‡∏î‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏´‡∏¢‡∏î‡∏ó‡∏µ‡πà $d$ ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ (‡∏à‡∏ô‡∏ñ‡∏∂‡∏á $\infty$) ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤‡∏à‡∏°‡∏ô‡πâ‡∏≥ ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å‡∏ô‡∏±‡∏¢‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ ‡∏ô‡πâ‡∏≥‡∏ù‡∏ô‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏´‡∏¢‡∏î‡∏ó‡∏µ‡πà $0$ ‡∏ñ‡∏∂‡∏á $d-1$ ‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤‡∏à‡∏°‡∏ô‡πâ‡∏≥‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á

‡πÉ‡∏´‡πâ $Y$ ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ó‡∏ô**‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡πâ‡∏≥‡∏ù‡∏ô**‡∏ó‡∏µ‡πà‡∏´‡∏¢‡∏î‡∏•‡∏á‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡πà‡∏≤‡∏à‡∏°‡∏ô‡πâ‡∏≥ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ß‡πà‡∏≤

$$
P(X \ge d) = P(Y = d-1)
$$

‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å $P(Y=d)$ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å ${H(m,d)}$ ‡∏ô‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏µ‡πâ

$$
\begin{align}
E(X) &= \sum_{d \in \mathbb{N}_0} P(Y=d) \\
     &= \sum_{d \in \mathbb{N}_0} \frac{H(m,d)}{n^d}
\end{align}
$$

‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡πÄ‡∏ä‡πà‡∏ô‡∏Å‡∏±‡∏ô‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏á‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ $S$ ‡∏ó‡∏µ‡πà‡∏¢‡∏∏‡πà‡∏á‡∏¢‡∏≤‡∏Å‡∏≠‡∏µ‡∏Å‡∏ï‡πà‡∏≠‡πÑ‡∏õ


## ‡πÇ‡∏Ñ‡πâ‡∏î

``` python
from fractions import Fraction
from itertools import count

def composition(n):
    for i in range(n+1):
        yield i, n-i

def choose(n, r, mem={}):
    if (n,r) not in mem:
        if r == 0 or r == n:
            mem[n,r] = 1
        else:
            mem[n,r] = choose(n-1, r) + choose(n-1, r-1)
    return mem[n,r]

def find_intervals(depths):
    k = 0
    intervals = []
    for i, j in zip(count(0), count(1)):
        if j == len(depths):
            intervals += [(k, j)]
            break
        elif depths[i] < depths[k] and depths[i] < depths[j]:
            intervals += [(k, i)]
            k = i
    return intervals

def transform(depths):
    intervals = find_intervals(depths)
    capacities = [0 for _ in intervals]
    for i, (a, b) in enumerate(intervals):
        for c in range(a, b):
            if depths[c] < depths[a]:
                break
            capacities[i] += depths[c] - depths[a]
    sizes = [b-a for a, b in intervals]
    sizes[0] += 1
    sizes[-1] -= 1
    return capacities, sizes

def calculate_expectation(depths):
    capacities, widths = transform(depths)
    n = len(depths)
    m = len(capacities)
    limit = sum(capacities) + 1
    hold = [[0 for _ in range(limit)] for _ in range(m+1)]
    hold[0][0] = 1
    acc_capacity = 0
    for i, (capacity, width) in enumerate(zip(capacities, widths)):
        acc_capacity += capacity
        for d in range(acc_capacity+1):
            for a, b in composition(d):
                hold[i+1][d] += choose(d, b) * width**b * hold[i][a]
    return sum(Fraction(hold[m][d], n**d) for d in range(limit))

def formatting(frac, prime=1_000_000_007):
    return frac.numerator * pow(frac.denominator, prime-2, prime) % prime

for t in range(int(input())):
    _ = input()
    depths = [int(x) for x in input().split()]
    answer = calculate_expectation(depths)
    print(f'Case #{t+1}: {formatting(answer)}')
```



[problem statement]: //facebook.com/codingcompetitions/hacker-cup/2020/final-round/problems/C

[expectation]: //en.wikipedia.org/wiki/Expected_value
[algorithm]: //en.wikipedia.org/wiki/Algorithm
[brute force]: //en.wikipedia.org/wiki/Brute-force_search
[dynamic programming]: //en.wikipedia.org/wiki/Dynamic_programming
